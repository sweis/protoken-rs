{
  "description": "Protoken wire format test vectors (canonical proto3). All binary data is URL-safe base64 (no padding). Any change in these values indicates a wire format regression.",
  "generated_by": "gen_test_vectors",
  "vectors": [
    {
      "expected_base64": "EAEYASIIAQIDBAUGBwgogOLPqgY",
      "expected_len": 20,
      "input": {
        "algorithm": 1,
        "expires_at": 1700000000,
        "key_id_base64": "AQIDBAUGBwg",
        "key_id_type": 1
      },
      "name": "payload_hmac_keyhash",
      "type": "payload"
    },
    {
      "expected_base64": "EAIYASIIqqqqqqqqqqoogKSn2gY",
      "expected_len": 20,
      "input": {
        "algorithm": 2,
        "expires_at": 1800000000,
        "key_id_base64": "qqqqqqqqqqo",
        "key_id_type": 1
      },
      "name": "payload_ed25519_keyhash",
      "type": "payload"
    },
    {
      "expected_base64": "EAIYAiIgu7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7sogOb-iQc",
      "expected_len": 44,
      "input": {
        "algorithm": 2,
        "expires_at": 1900000000,
        "key_id_base64": "u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7s",
        "key_id_type": 2
      },
      "name": "payload_ed25519_pubkey",
      "type": "payload"
    },
    {
      "expected_base64": "EAEYASIIEREREREREREogOLPqgYw8JPPqgY48JPPqgZCCnVzZXI6YWxpY2VKD2FwaS5leGFtcGxlLmNvbQ",
      "expected_len": 61,
      "input": {
        "algorithm": 1,
        "audience": "api.example.com",
        "expires_at": 1700000000,
        "issued_at": 1699990000,
        "key_id_base64": "ERERERERERE",
        "key_id_type": 1,
        "not_before": 1699990000,
        "subject": "user:alice"
      },
      "name": "payload_hmac_full_claims",
      "type": "payload"
    },
    {
      "expected_base64": "EAEYASII__________8o____________AQ",
      "expected_len": 25,
      "input": {
        "algorithm": 1,
        "expires_at": 18446744073709551615,
        "key_id_base64": "__________8",
        "key_id_type": 1
      },
      "name": "payload_hmac_max",
      "type": "payload"
    },
    {
      "expected_base64": "EAEYASIIIiIiIiIiIiIogOLPqgZSBWFkbWluUgRyZWFkUgV3cml0ZQ",
      "expected_len": 40,
      "input": {
        "algorithm": 1,
        "expires_at": 1700000000,
        "key_id_base64": "IiIiIiIiIiI",
        "key_id_type": 1,
        "scopes": [
          "admin",
          "read",
          "write"
        ]
      },
      "name": "payload_hmac_scopes",
      "type": "payload"
    },
    {
      "expected_base64": "ChQQARgBIghmsHh3jqsc1CiA4s-qBhIg_FZ5zp_Me8pY33q916M6rNNclfksiQSTnaWBrdeNkM4",
      "expected_len": 56,
      "input": {
        "algorithm": "hmac",
        "expires_at": 1700000000,
        "key_hash_base64": "ZrB4d46rHNQ",
        "signing_key_base64": "CAESM3Byb3Rva2VuLXRlc3QtdmVjdG9yLWtleS1kby1ub3QtdXNlLWluLXByb2R1Y3Rpb24hIQ"
      },
      "name": "signed_hmac",
      "type": "signed_token"
    },
    {
      "expected_base64": "ChQQAhgBIghhulHJ2cOw9yiApKfaBhJAO1FmQzgooh6l1LRtCBsPbe4lMohhV9-zgo8uP1OcHbBMVgngyKvjBsqzGgzQyLmrZ7vfTGiiuBKekeox5t2IBQ",
      "expected_len": 88,
      "input": {
        "algorithm": "ed25519",
        "expires_at": 1800000000,
        "key_hash_base64": "YbpRydnDsPc",
        "key_id_type": "key_hash",
        "signing_key_base64": "CAISIDzEvslh0L9CilijI4EpkuqM2AOBSHHuiyR33DNirEYZGiC1QJ-8F00jcoNzJqIhdKkS61okENNE1EE5z5U719uZ6A"
      },
      "name": "signed_ed25519_keyhash",
      "type": "signed_token"
    },
    {
      "expected_base64": "CiwQAhgCIiC1QJ-8F00jcoNzJqIhdKkS61okENNE1EE5z5U719uZ6CiApKfaBhJAuXkWYK8QpYpc_5Qav8ihop1x-gm0se0wza7Vu-GeG7okglb-f6nGaymlSSKEqH7urO-mYvWV7N63gv9njijHDw",
      "expected_len": 112,
      "input": {
        "algorithm": "ed25519",
        "expires_at": 1800000000,
        "key_id_type": "public_key",
        "signing_key_base64": "CAISIDzEvslh0L9CilijI4EpkuqM2AOBSHHuiyR33DNirEYZGiC1QJ-8F00jcoNzJqIhdKkS61okENNE1EE5z5U719uZ6A"
      },
      "name": "signed_ed25519_pubkey",
      "type": "signed_token"
    },
    {
      "expected_base64": "ZrB4d46rHNQ",
      "input_base64": "cHJvdG9rZW4tdGVzdC12ZWN0b3Ita2V5LWRvLW5vdC11c2UtaW4tcHJvZHVjdGlvbiEh",
      "name": "key_hash_hmac",
      "type": "key_hash"
    },
    {
      "expected_base64": "YbpRydnDsPc",
      "input_base64": "tUCfvBdNI3KDcyaiIXSpEutaJBDTRNRBOc-VO9fbmeg",
      "name": "key_hash_ed25519_pubkey",
      "type": "key_hash"
    }
  ]
}
